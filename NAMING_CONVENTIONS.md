# Crown Chronicle - 命名规范文档

## 概述

为了确保项目的一致性和可维护性，所有的角色、事件和其他游戏资源都必须遵循统一的命名规范。

**重要更新**：系统已实现自动ID生成机制，AI助手无需手动管理ID，只需专注于内容创建。

## 自动ID生成机制

**系统特性**：
- ✅ 角色ID：系统根据角色姓名自动生成（如"武则天"→"wuzetian"）  
- ✅ 事件ID：系统根据角色ID和序号自动生成（如"wuzetian_event_001"）
- ✅ 选项ID：系统根据事件ID和选项索引自动生成（如"wuzetian_event_001_choice_01"）

**对AI助手的影响**：
- AI只需提供角色姓名（name字段），无需生成或管理角色ID
- AI只需提供事件标题（title字段），无需生成或管理事件ID  
- AI只需提供选项文本（text字段），无需生成或管理选项ID

## 角色命名规范（系统内部）

### 角色ID规范（系统自动生成）
- **格式**: 全小写英文字母，不使用下划线、连字符或其他特殊字符
- **历史人物**: 使用完整的拼音名字
- **复姓处理**: 直接连写，不使用分隔符
- **生成逻辑**: 系统内置字符映射表，自动将中文姓名转换为规范ID

### 系统生成示例：
```yaml
✅ 自动生成格式：
- "武则天" → wuzetian
- "霍光" → huoguang  
- "上官婉儿" → shangguanwaner
- "杨贵妃" → yangguifei
- "尉迟恭" → weichigong
```

### 错误示例：
```yaml
❌ 错误格式：
- wu_zetian     # 不要使用下划线
- wu-zetian     # 不要使用连字符
- WuZeTian      # 不要使用大小写混合
- yang_guifei   # 不要使用下划线
- wei_chi_gong  # 不要使用下划线分割
```

## 事件命名规范（系统自动生成）

### 事件ID格式（系统生成）
```
[角色ID]_event_[序号]
```

### 生成规则：
- 角色ID：从角色姓名自动生成（无下划线）
- 序号：3位数字，从001开始自动递增
- 格式：固定使用"_event_"分隔符

### 系统生成示例：
```yaml
✅ 自动生成格式：
- wuzetian_event_001    # 武则天的第1个事件
- huoguang_event_015    # 霍光的第15个事件
- yangguifei_event_008  # 杨贵妃的第8个事件
```

### 文件命名（系统生成）：
```yaml
✅ 文件路径示例：
- characters/yangguifei/events/yangguifei_event_001.yaml
- characters/wuzetian/events/wuzetian_event_005.yaml  
- characters/huoguang/events/huoguang_event_012.yaml
```

## 选项命名规范（系统自动生成）

### 选项ID格式（系统生成）
```
[角色ID]_event_[事件序号]_choice_[选项序号]
```

### 生成规则：
- 角色ID：从角色姓名自动生成（无下划线）
- 事件序号：3位数字，与对应事件一致
- 选项序号：2位数字，从01开始按顺序排列

### 系统生成示例：
```yaml
✅ 自动生成格式：
- wuzetian_event_001_choice_01   # 武则天事件001的选项1
- huoguang_event_015_choice_02   # 霍光事件015的选项2
- yangguifei_event_008_choice_03 # 杨贵妃事件008的选项3
```

## 文件和目录命名

### 目录结构
```
characters/
├── yangguifei/         # 角色目录名 = 角色ID（修正后）
│   ├── character.yaml  # 固定文件名
│   └── events/         # 固定目录名
│       ├── yangguifei_001.yaml
│       └── yangguifei_008.yaml
```

### 规则：
- 角色目录名与角色ID完全一致
- `character.yaml` 为固定文件名
- `events/` 为固定目录名
- 事件文件名格式：`[事件ID].yaml`（系统自动生成ID）

## AI内容创建指南

### 对AI助手的新工作流程：
1. **创建角色时**：
   - 只需提供角色姓名（name字段）
   - 系统自动生成规范的角色ID
   - 专注于角色属性、背景等内容创建

2. **创建事件时**：
   - 只需提供事件标题（title字段）
   - 系统自动生成事件ID和序号
   - 专注于事件内容、对话、选项等创建

3. **创建选项时**：
   - 只需提供选项文本（text字段）
   - 系统自动生成选项ID和序号
   - 专注于选项效果、后果等内容创建

## 系统内部ID映射表

| 中文名称 | 系统生成ID | 说明 |
|---------|-----------|------|
| 武则天   | wuzetian  | 女皇，唐朝 |
| 霍光     | huoguang  | 大将军，汉朝 |
| 杨贵妃   | yangguifei | 杨玉环，唐朝 |
| 上官婉儿 | shangguanwaner | 女官，唐朝 |
| 尉迟恭  | weichigong | 大将，唐朝 |
| 长孙无忌 | zhangsunwuji | 宰相，唐朝 |
| 狄仁杰  | direnjie  | 大臣，唐朝 |

*注：此映射表在系统代码中维护，AI助手无需记忆或管理*

## 实施指南

### 对于开发者：
1. 维护和扩展系统内部的ID生成映射表
2. 确保自动生成的ID符合命名规范
3. 在代码审查时验证ID生成逻辑的正确性

### 对于AI助手：
1. **无需管理ID**：专注于内容创建，让系统处理所有ID生成
2. **提供准确姓名**：确保角色姓名准确，系统会生成正确的ID
3. **使用系统函数**：通过list_characters了解现有角色，通过get_character_info获取详细信息

## 迁移说明

### 已完成的系统改进：
```
✅ 实现了自动ID生成机制
✅ 更新了AI助手的function calling接口
✅ 移除了AI助手手动管理ID的需求
✅ 优化了工作流程，提高了内容创建效率
```

### 历史兼容性：
- 现有的手动创建的ID仍然有效
- 新创建的内容将使用自动生成的ID格式
- 系统支持混合模式，逐步迁移到新格式

遵循这些命名规范和自动化机制将确保项目的一致性和可维护性，同时大大简化了AI助手的工作流程。
